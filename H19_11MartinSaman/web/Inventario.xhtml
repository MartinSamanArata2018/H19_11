<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <h:head>
        <title>Equipos Inform√°ticos</title>
    </h:head>
    <h:body>
        <ui:include src="Menu.xhtml"/>
        <h:form id="frmRegistrarInventario">
            <h:panelGrid columns="2">
                <p:outputLabel value="Equipo"/>
                <p:selectOneMenu required="true" filter="true" filterMatchMode="contains"
                                 value="#{inventarioC.inventario.equipo.IDEQ}">
                    <f:selectItems value="#{equipoC.listaEquipo}" var="equipo" 
                                   itemLabel="#{equipo.NOMEQ} - #{equipo.MAREQ} - #{equipo.MODEQ}" itemValue="#{equipo.IDEQ}"/>
                </p:selectOneMenu>
                <p:outputLabel value="Cantidad"/>
                <p:spinner value="#{inventarioC.inventario.CNTINV}" required="true" requiredMessage="Ingresar apellidos"/>
                <p:outputLabel value="Fecha"/>
                <p:calendar value="#{inventarioC.inventario.FECINV}"/>
            </h:panelGrid>
            <p:commandButton value="Guardar" actionListener="#{inventarioC.registrar()}" update="frmRegistrarInventario :frmDatosInventario"/>
        </h:form>
        <h:form id="frmDatosInventario">
            <p:dataTable id="tblInventario" var="inventario" 
                         selection="#{inventarioC.inventarioSeleccionado}"
                         selectionMode="single"
                         rowKey="#{inventario.IDINV}"
                         value="#{inventarioC.listaInventario}">

                <p:column headerText="Equipo">
                    <h:outputText value="#{inventario.equipo.MAREQ}"/>
                </p:column>
                <p:column headerText="Cantidad">
                    <h:outputText value="#{inventario.CNTINV}"/>
                </p:column>
                <p:column headerText="Tipo">
                    <h:outputText value="#{inventario.TIPINV eq 'E'? 'Entrada':'Salida'}"/>
                </p:column>
                <p:column headerText="Fecha">
                    <h:outputText value="#{inventario.FECINV}"/>
                </p:column>

            </p:dataTable>
            <p:contextMenu for="tblInventario">
                <p:menuitem value="Modificar" oncomplete="PF('dlgModInventario').show();" update=":frmModInventario"/>
                <p:menuitem value="Eliminar" actionListener="#{inventarioC.eliminar()}" update="frmDatosInventario"/>
            </p:contextMenu>
        </h:form>
        <p:dialog widgetVar="dlgModInventario">
            <h:form id="frmModInventario">
                <h:panelGrid columns="2">
                    <p:outputLabel value="Equipo"/>
                    <p:selectOneMenu required="true" filter="true" filterMatchMode="contains"
                                     value="#{inventarioC.inventarioSeleccionado.equipo.IDEQ}">
                        <f:selectItems value="#{equipoC.listaEquipo}" var="equipo" 
                                       itemLabel="#{equipo.NOMEQ} - #{equipo.MAREQ} - #{equipo.MODEQ}" itemValue="#{equipo.IDEQ}"/>
                    </p:selectOneMenu>
                    <p:outputLabel value="Cantidad"/>
                    <p:spinner value="#{inventarioC.inventarioSeleccionado.CNTINV}" required="true" requiredMessage="Ingresar apellidos"/>
                    <p:outputLabel value="Fecha"/>
                    <p:calendar value="#{inventarioC.inventarioSeleccionado.FECINV}"/>
                </h:panelGrid>
                <p:commandButton value="Modificar" actionListener="#{inventarioC.editar()}" update=":frmDatosInventario" oncomplete="PF('dlgModInventario').hide();"/>
            </h:form>
        </p:dialog>

    </h:body>
</html>

